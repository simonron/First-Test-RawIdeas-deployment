<!DOCTYPE html>
<html lang="en">

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="robots" content="noindex" />
	<title>Raw Ideas News Hacker App test</title>
	<script src="http://code.jquery.com/jquery.min.js" type="text/javascript"></script>
	<script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.3.14/angular.min.js"></script>
	<script src="jquery.tmpl.min.js" type="text/javascript"></script>
	<script src="https://cdn.firebase.com/js/client/2.2.1/firebase.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.0rc1/angular-route.min.js"></script>

	<link rel="stylesheet" href="./css/desktop.css" />
	<link rel="stylesheet" href="./css/mobile.css" />
	<link rel="stylesheet" href="./css/style.css" />
	<link rel="stylesheet" href="./css/override.css" />

	<script>
		var newsItem = new Array();
		var title = "blank";
		var url = "blank";
		var count = 0;
		var score = "blank";
		var app = angular.module("myApp", []);
		var ref = new Firebase("https://hacker-news.firebaseio.com/v0/");

		for (var i = 0; i < 10; i++) {
			getNews(i);
		};

		function getNews(i) {
			var itemRef;
			ref.child('topstories').child(i).on('value', function(snapshot) {
				if (itemRef) {
					itemRef.off();
				}
				var id = snapshot.val(); //create variables for the template
				itemRef = ref.child('item').child(id);
				itemRef.on('value', function(snapshot) {
					item = snapshot.val();
					title = item.title;
					url = item.url;
					score = item.score;
					count = i;
					newsItem = [count, title, score, url];
					console.log("count=" + count + " " + newsItem);
					$("div.hidden").remove(); //clears contents of div
					$(".clientTemplate").tmpl().appendTo("body");
				});
			});
		};

	</script>
</head>

<body>
	<div class="hidden">
		When this is working, this text will not be seen - please wait.</div>

			<script class="clientTemplate" type="text/x-jquery-tmpl">
				<div class="container">
					<div id='slot${count}'>
						News item ${count} is <a href='${url}' target="_blank"> ${title} </a> and has a score of ${score}
					</div>
				</div>
			</script>

	<!--end container-->
</body>
</html>

<script>
	document.write('<script src="http://' + (location.host || 'localhost').split(':')[0] + ':35729/livereload.js?snipver=1"></' + 'script>')
</script>